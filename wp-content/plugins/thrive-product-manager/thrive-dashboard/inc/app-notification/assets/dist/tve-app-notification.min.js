(()=>{var i={9947:(i,t,o)=>{var n=o(6593);i.exports=Backbone.Collection.extend({model:n})},6593:i=>{i.exports=Backbone.Model.extend({idAttribute:"id",defaults:{active:{},dismissed:{}},getDate:function(){if(this.has("start")&&this.get("start")){var i;let t=new Date(this.get("start")),o=new Date(null===(i=TD_Notification)||void 0===i?void 0:i.date_time_now).getTime()-t.getTime(),n=Math.floor(o/31536e6);if(n>0)return n+(1===n?" year ago":" years ago");let e=Math.floor(o/2592e6);if(e>0)return e+(1===e?" month ago":" months ago");let s=Math.floor(o/864e5);if(s>0)return s+(1===s?" day ago":" days ago");let a=Math.floor(o/36e5);if(a>0)return a+(1===a?" hour ago":" hours ago");let c=Math.floor(o/6e4);return c>0?c+(1===c?" minute ago":" minutes ago"):"just now"}return""}})},7995:i=>{jQuery,i.exports=Backbone.View.extend({render:function(){return this}})},5862:(i,t,o)=>{!function(){const t=o(7995);i.exports=t.extend({notificationType:"Active",translate:TD_Notification.t,initialize:function(i){i&&i.notificationType&&(this.notificationType=i.notificationType)},render:function(){return this.$el.html(this.getHtml()),this},getHtml:function(){let i=TD_Notification.notify_class?TD_Notification.notify_class:"",t='<div class="no-notifications no-notifications-'+i+'">',o=this.notificationType;var n,e;return"Active"===o&&(t+='<img alt="Dannie the Detective" src="'+(null===(n=TD_Notification)||void 0===n?void 0:n.image_url)+'"><div class="great-scott great-scott-'+i+'">'+this.translate.no_new_title+'</div><div class="no-new-notifications no-new-notification-'+i+'">'+this.translate.no_new+'</div><span class="switch-notification-type toggle-to-dismissed switch-notification-type-'+i+'">'+this.translate.see_dismissed+"</span>"),"Dismissed"===o&&(t+='<img alt="Dannie the Detective" src="'+(null===(e=TD_Notification)||void 0===e?void 0:e.image_url)+'"><div class="great-scott great-scott-'+i+'">'+this.translate.no_new_title+'</div><div class="no-new-notifications no-new-notification-'+i+'">'+this.translate.no_dismissed+'</div><span class="switch-notification-type toggle-to-active switch-notification-type-'+i+'">'+this.translate.see_new+"</span>"),t+="</div>",t}})}(jQuery)},7621:(i,t,o)=>{!function(){const t=o(7995);i.exports=t.extend({render:function(){return this.$el.append(this.getHtml()),this},getHtml:function(){let i=TD_Notification.notify_class?TD_Notification.notify_class:"",t='<div class="tve-notification notification-'+i+'"><div class="icon icon-'+i+'"><svg class="tve-circle-close type-'+this.model.get("type")+'" xmlns="http://www.w3.org/2000/svg">><use xlink:href="#icon-notification-type-'+this.model.get("type")+'"></use></svg></div><div class="body"><div class="title title-'+i+'"><div>'+this.model.get("title")+"</div>";return this.model.getDate()&&(t+='<div class="date date-'+i+'">'+this.model.getDate()+"</div>"),t+='</div><div class="notification-content notification-content-'+i+'">'+this.addMediaPlayer(this.model.get("content"))+'</div><div class="tvd-notification-actions">',this.model.get("button1_action")&&(t+='<a type="button" class="tve-dash-button notify-primary notify-primary-'+i+'" href="'+this.model.get("button1_action")+'" target="_blank" rel="noopener noreferrer">'+this.model.get("button1_label")+"</a>"),this.model.get("button2_action")&&(t+='<a type="button" class="tve-dash-button notify-secondary notify-secondary-'+i+'" href="'+this.model.get("button2_action")+'" target="_blank" rel="noopener noreferrer">'+this.model.get("button2_label")+"</a>"),1!=this.model.get("dismissed")&&(t+='<span class="dismiss-notification dismiss-notification-'+i+'" data-id="'+this.model.get("notification_id")+'">Dismiss</span>'),t+="</div></div></div>",t},addMediaPlayer:function(i){i=i.replace(/&nbsp;/g,"<br>");const t=/(https?:\/\/\S+\.(mp4|webm|ogg))/gi;t.test(i)&&(i=i.replace(t,((i,t)=>`<div class="notification-content-video-container"><video class="custom-video-player" controls>\n                        <source src="${t}" type="video/mp4">\n                        Your browser does not support the video tag.\n                    </video></div>`)));const o=/(https?:\/\/(www\.)?youtube\.com\/watch\?v=[\w-]+|https?:\/\/youtu\.be\/[\w-]+)/gi;o.test(i)&&(i=i.replace(o,((i,t)=>`<div class="notification-content-video-container"><iframe class="custom-iframe" src="https://www.youtube.com/embed/${new URLSearchParams(new URL(t).search).get("v")||t.split("/").pop()}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>`))),i=i.replace(/<figure[^>]*>\s*<div[^>]*>\s*(https?:\/\/(www\.)?youtube\.com\/watch\?v=[\w-]+|https?:\/\/youtu\.be\/[\w-]+)\s*<\/div>\s*<\/figure>/gi,((i,t)=>`<div class="notification-content-video-container"><iframe class="custom-iframe" src="https://www.youtube.com/embed/${new URLSearchParams(new URL(t).search).get("v")||t.split("/").pop()}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>`));const n=/<a[^>]*>\s*(https?:\/\/\S+\.(gif))\s*<\/a>/gi;n.test(i)&&(i=i.replace(n,((i,t)=>`<div class="notification-content-image-container"><img class="custom-image-player" src="${t}" alt="GIF"></div>`)));const e=/(https?:\/\/\S+\.(jpg|jpeg|png|gif))/gi;return i.includes("<img")||(e.test(i)&&(i=i.replace(e,((i,t)=>`<div class="notification-content-image-container"><img class="custom-image-player" src="${t}" alt="Image"></div>`))),/<\/?[a-z][\s\S]*>/i.test(i)||(i=i.replace(/\n/g,"<br>"))),i}})}(jQuery)},5944:(i,t,o)=>{!function(t){const n=o(7995);i.exports=n.extend({dismissedCount:0,activeCount:0,events:{"click .tvd-notifications-btn":"open","click .td-app-notification-counter-holder":"open","click .text-notify-t-automator":"open"},initialize:function(i){t(window).on("scroll",this.adjustDrawerPosition.bind(this)),t(document).on("click",this.handleDocumentClick.bind(this)),i&&(this.activeCount=i.activeCount,this.dismissedCount=i.dismissedCount)},adjustDrawerPosition:function(){const i=124+t(window).scrollTop()+"px";this.$(".td-app-notification-drawer").css("top",i)},render:function(){return this.$(".td-app-notification-counter-holder").text(this.activeCount),this.activeCount>=1?this.$(".td-app-notification-counter-holder").show():this.$(".td-app-notification-counter-holder").hide(),this},open:function(){t(".td-app-notification-overlay").removeClass("close"),t(".td-app-notification-drawer").addClass("open")},handleDocumentClick:function(i){t(i.target).closest(".td-app-notification-overlay.overlay").length&&(t(".td-app-notification-overlay").addClass("close"),t(".td-app-notification-drawer").removeClass("open"))}})}(jQuery)},2734:(i,t,o)=>{!function(t){const n=o(7995);i.exports=n.extend({hideDismissAll:!1,events:{"click .dismiss-all":"dismissAll"},initialize:function(i){i&&i.hideDismissAll&&(this.hideDismissAll=i.hideDismissAll),this.listenTo(this.collection,"change:dismiss-all",this.collectionChanged)},render:function(){return this.$el.html(this.getHtml()),this},getHtml:function(){let i=TD_Notification.notify_class?TD_Notification.notify_class:"",t='<div class="pagination pagination-'+i+'"></div><div class="dismiss-all dismiss-all-'+i+'">';return this.hideDismissAll||(t+='<span class="dismiss-all dismiss-all-'+i+'">Dismiss All</span>'),t+="</div>",t},dismissAll:function(){this.collection.each((function(i){const t=TD_Notification.data.active.findIndex((t=>t.notification_id==i.get("notification_id")));-1!==t&&TD_Notification.data.active.splice(t,1),TD_Notification.data.dismissed.unshift(i.toJSON())})),this.collectionChanged(),this.dismissAllNotification()},dismissAllNotification:function(){var i;t.ajax({type:"POST",url:TD_Notification.baseUrl+"/dismiss-all",headers:{"X-WP-Nonce":null===(i=TD_Notification)||void 0===i?void 0:i.dismiss_nonce},success:function(i){},error:function(i,t,o){console.error("Error marking notification as read:",o)}})},collectionChanged:function(){this.trigger("collectionChanged",{notification_type:"Active",collection:this.collection})}})}(jQuery)},7672:(i,t,o)=>{!function(t){let n=o(7995);i.exports=n.extend({data:{notification_type:"Active",notification_number:0,active_count:0,dismissed_count:0},events:{"click .toggle-to-dismissed":"toggleNotification","click .toggle-to-active":"toggleNotification"},initialize:function(i){i&&(this.data.active_count=i.activeCount,this.data.dismissed_count=i.dismissedCount,this.data.notification_type=i.notificationType),"Dismissed"===this.data.notification_type&&this.collection.each((function(i){0==i.get("dismissed")&&i.set("dismissed",1)})),this.data.notification_number=this.collection.length},render:function(){return this.$el.html(this.getHtml()),this},getHtml:function(){let i="",t=TD_Notification.notify_class?TD_Notification.notify_class:"";return"Active"===this.data.notification_type?i+='<span class="tvd-notification-number notification-number-'+t+'">('+this.data.notification_number+") New Notifications</span>":"Dismissed"===this.data.notification_type&&(i+='<span class="tvd-notification-number notification-number-'+t+'"> ('+this.data.notification_number+") Notifications</span>"),i+='<div class="toggle-notifications">',"Active"===this.data.notification_type&&this.data.dismissed_count>0&&(i+='<span class="toggle-to-dismissed toggle-notifications toggle-'+t+'">Dismissed Notifications</span>'),"Dismissed"===this.data.notification_type&&(i+='<span class="toggle-to-active toggle-notifications toggle-'+t+'">Active Notifications</span>'),i+="</div>",i+='<span class="tvd-close-notification-drawer close-notification-'+t+'">',i+='<svg class="icon-tve-dash-notification-cross"><use xlink:href="#icon-tvd-notification-cross"></use></svg>',i+="</span>",i},toggleNotification:function(i){const o=t(i.currentTarget).hasClass("toggle-to-dismissed")?"Dismissed":"Active";this.data.notification_type!==o&&(this.data.notification_type=o,this.trigger("notificationTypeChanged",{notification_type:o})),i.stopPropagation()}})}(jQuery)},3256:(i,t,o)=>{!function(t){let n=o(7995),e=o(7672),s=o(2734),a=o(7621),c=o(5862);i.exports=n.extend({headerView:null,hideDismissAll:!1,notificationType:"Active",dismissedCount:0,activeCount:0,events:{"click .tvd-close-notification-drawer":"close","click .dismiss-notification":"dismiss","click .switch-notification-type":"toggleNotification"},initialize:function(i){i&&(this.activeCount=i.activeCount,this.dismissedCount=i.dismissedCount,this.hideDismissAll="Dismissed"===i.notificationType||this.activeCount<2,this.notificationType=i.notificationType),this.listenTo(this.collection,"change:dismiss",this.collectionChanged)},render:function(){this.renderHeader();const i=this.$(".td-app-notification-wrapper");return this.collection.length>0?(i.html('<div class="tvd-notifications-list"></div>'),this.renderList()):(i.empty(),new c({el:i,notificationType:this.notificationType}).render()),0===i.find(".notification-footer").length&&this.renderFooter(),this},renderHeader:function(){this.headerView=new e({el:this.$(".td-app-notification-header"),collection:this.collection,activeCount:this.activeCount,dismissedCount:this.dismissedCount,notificationType:this.notificationType}).render(),this.listenTo(this.headerView,"notificationTypeChanged",this.notificationTypeChanged)},renderList:function(){const i=this.$(".tvd-notifications-list");i.empty(),this.collection.map((function(i){return new a({model:i})})).forEach((function(t){i.append(t.render().el)}))},renderFooter:function(){const i=t(".notification-footer");i.empty(),new s({el:i,collection:this.collection,notificationType:this.notificationType,hideDismissAll:this.hideDismissAll}).render()},toggleNotification:function(i){const o=t(i.currentTarget).hasClass("toggle-to-dismissed")?"Dismissed":"Active";this.trigger("notificationTypeChanged",{notification_type:o})},dismiss:function(i){i.preventDefault();let o=t(i.currentTarget).data("id"),n=this.collection.findWhere({notification_id:String(o)});if(n){this.collection.remove(n);const i=TD_Notification.data.active.findIndex((i=>i.notification_id==o));-1!==i&&TD_Notification.data.active.splice(i,1),TD_Notification.data.dismissed.unshift(n.toJSON()),this.dismissNotification(o),this.collectionChanged()}},dismissNotification:function(i){var o;t.ajax({type:"POST",url:TD_Notification.baseUrl+"/dismiss",headers:{"X-WP-Nonce":null===(o=TD_Notification)||void 0===o?void 0:o.dismiss_nonce},data:{notification_id:i},success:function(i){},error:function(i,t,o){console.error("Error marking notification as read:",o)}})},close:function(){this.trigger("notificationTypeChanged",{notification_type:"Active"}),t(".td-app-notification-overlay").addClass("close"),t(".td-app-notification-drawer").removeClass("open")},collectionChanged:function(){this.trigger("collectionChanged",{notification_type:"Active",collection:this.collection})},notificationTypeChanged:function(i){this.trigger("notificationTypeChanged",i)}})}(jQuery)}},t={};function o(n){var e=t[n];if(void 0!==e)return e.exports;var s=t[n]={exports:{}};return i[n](s,s.exports,o),s.exports}TD_Notification=TD_Notification||{};const n=o(5944),e=o(3256),s=o(9947),a=o(2734);var c;(c=jQuery)(document).ready((function(){let i="Active",t=[],o=null,l=null;const d=function(){var r,f,u,h,p,v,m,g,y,_;const w="Active"===i?null===(r=TD_Notification)||void 0===r||null===(f=r.data)||void 0===f?void 0:f.active:null===(u=TD_Notification)||void 0===u||null===(h=u.data)||void 0===h?void 0:h.dismissed,T=null===(p=TD_Notification)||void 0===p||null===(v=p.data)||void 0===v||null===(m=v.dismissed)||void 0===m?void 0:m.length,D=null===(g=TD_Notification)||void 0===g||null===(y=g.data)||void 0===y||null===(_=y.active)||void 0===_?void 0:_.length;D<=0&&c(".notification-indicator").parent().remove();const C=new s(w);new n({el:c(".td-app-notification-counter"),collection:C,activeCount:D,dismissedCount:T}).render(),o=new e({el:c(".td-app-notification-holder"),collection:C,notificationType:i,dismissedCount:T,activeCount:D}),o.render(),l=new a({el:c(".notification-footer"),collection:C,notificationType:i,hideDismissAll:"Dismissed"===i||D<2}),l.render(),o.on("collectionChanged",(function(i){t=i.collection.toJSON(),d()})),l.on("collectionChanged",(function(i){t=i.collection.toJSON(),d()})),o.on("notificationTypeChanged",(function(t){i=null!=t&&t.notification_type?null==t?void 0:t.notification_type:"Active",d()})),c(".tve-notification").last().css("border-bottom","none")};window.render_ui=d;const r=setInterval((function(){c(".td-app-notification-counter").is(":visible")&&(d(),clearInterval(r))}),100);c(".td-app-notification-counter").is(":visible")&&(d(),clearInterval(r));const f=setInterval((function(){c(".td-app-notification-wrapper").is(":empty")?d():clearInterval(f)}),100);c(document).on("keydown",(function(i){"Escape"===i.key&&(c(".td-app-notification-overlay").addClass("close"),c(".td-app-notification-drawer").removeClass("open"))})),1==function(i){i=i.replace(/[\[\]]/g,"\\$&");const t=new RegExp("[?&]"+i+"(=([^&#]*)|&|#|$)").exec(window.location.href);return t?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null}("notify")&&(c(".td-app-notification-overlay").removeClass("close"),c(".td-app-notification-drawer").addClass("open"))}))})();